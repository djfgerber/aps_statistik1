# (PART) Zwei Gruppen vergleichen {-}


# Mittelwertunterschied einer intervallskalierten Variable

Bislang wurde versucht mithilfe _einer_ Stichprobe eine Aussage über _eine_ Population zu treffen. Dies setzt voraus, dass der Erwartungswert bereits aus früheren Untersuchungen bekannt ist oder theoretisch hergeleitet werden kann (Beispiel zirkadianer Rhythmus). In der Realität ist dies oft nicht der Fall. Es muss also gleichzeitig etwas über eine potenziell veränderte Population und über die Referenzpopulation herausgefunden werden. Im experimentellen Kontext entspricht dies dem Vergleich der Experimental- mit der Kontrollgruppe. Im observationellen Kontext wird die Referenzgruppe willkürlich bestimmt.

:::{.example #breakup name="Trennungsschmerz"}

```{r exm-breakup}
gen_exm_t_welch <- function(mu1,
                            s1,
                            n1,
                            mu2,
                            s2,
                            n2,
                            var_name,
                            x_min,
                            x_max,
                            file_name,
                            group_labels,
                            x_label_position,
                            y_label_position_hist,
                            y_label_position_dens,
                            binwidth,
                            plot_bag) {
  
  mu0 <- 0
  set.seed(61)
  x1 <- rnorm(n1, mu1, s1) %>% 
    crop(x_min, x_max)
  x2 <- rnorm(n2, mu2, s2) %>% 
    crop(x_min, x_max)
  x1_mean <- x1 %>% mean()
  x2_mean <- x2 %>% mean()
  x1_sd <- x1 %>% sd()
  x2_sd <- x2 %>% sd()
  s_p <- sqrt(weighted.mean(c(x1_sd^2, x2_sd^2), c(n1-1, n2-1)))
  s_t <- s_p * sqrt((1/n1+1/n2))
  s_w <- sqrt(x1_sd^2/n1 + x2_sd^2/n2)
  x_mean <- x1_mean - x2_mean
  df_t <- n1 + n2 - 2
  df_w <- s_w^4 / (x1_sd^4 / (n1^2* (n1-1))+x2_sd^4 / (n2^2* (n2-1)))
  p_value_the_t <- 2*(1-pt(x_mean/s_t, df_t))
  p_value_the_w <- 2*(1-pt(x_mean/s_w, df_w))

  dd <- tibble(!!var_name := c(x1,x2),
         Gruppe = c(rep(group_labels[1],n1), rep(group_labels[2], n2))) %>% 
    write_sav(file_name)

  jmv_res <- dd %>%
    jmv::ttestIS(formula = as.formula(str_c(var_name, "~Gruppe")),
                desc = TRUE,
                 welchs = TRUE, 
                 mann = TRUE, 
                 effectSize = TRUE)
  jmv_res_test <- jmv_res$ttest$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(stud|welc)\\]',"\\1"))
  jmv_res_desc <- jmv_res$desc$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(1|2)\\]',"\\1"))

  if(plot_bag){
    scores_hover1 <- rnorm(20, 3, s1) %>% 
        crop(x_min, x_max)
    scores_hover2 <- rnorm(20, 7, s1) %>% 
        crop(x_min, x_max)
    plot_ball_bag_different <- plot_ball_bag_two_samples(
      scores_bag1 = rnorm(200, 3, s1) %>% 
        crop(x_min, x_max),
      scores_bag2 = rnorm(200, 7, s2) %>% 
        crop(x_min, x_max),
      scores_hover1 = scores_hover1,
      scores_hover2 = scores_hover2,
      score_name = var_name,
      no_legend = TRUE
    )
    
    plot_ball_bag_same <- plot_ball_bag_two_samples(
      scores_bag1 = rnorm(200, 5, s1) %>% 
        crop(x_min, x_max),
      scores_bag2 = rnorm(200, 5, s2) %>% 
        crop(x_min, x_max),
      scores_hover1 = scores_hover1,
      scores_hover2 = scores_hover2,
      score_name = var_name
    )
  }
  
  # distribution if H_0 were true
  n_samples <- 3000L
  x1_means <- 1:n_samples %>%
    map_dbl(~ rnorm(n1,mean(mu1, mu2), s1) %>% 
            crop(x_min, x_max) %>% 
            mean())
  x2_means <- 1:n_samples %>%
    map_dbl(~ rnorm(n2, mean(mu1, mu2), s2) %>% 
              crop(x_min, x_max) %>% 
              mean()
    )
  means_diff <- x1_means - x2_means
  q975_x_means <- means_diff %>% quantile(c(0.975)) %>% unlist() %>% unname()
  q025_x_means <- means_diff %>% quantile(c(0.025)) %>% unlist() %>% unname()
  p_value_emp <- mean(abs(means_diff) > abs(x_mean))
  
  plot_hist <- plot_hist_denstiy_expected_value1(
    means_diff,
    str_c(var_name, "-Mittelwertdifferenz"),
    binwidth,
    list(
      "Student-t" = function(x)
        dt((x-mu0)/s_t, df_t) / s_t,
      "Welch t" = function(x)
        dt((x-mu0)/s_w, df_w) / s_w)
      )
  
  x_bounds <- 3.5*s_w*c(-1, 1)
  line_xlim <- xlim(x_bounds)
  x_range <- seq(x_bounds[1], x_bounds[2], length.out = 1000)
  
  create_text_data <- function(x,y,z){
    plot_attr_reja_pval$create_text_data(x_label_position,x,y,z)
  }
  
  histogram_data <- tibble(x = rep(means_diff, 2),
                           plot_type = rep(
                             c("Histogram p-Wert", "Histogram Ablehnungsbereich"),
                             each = length(means_diff)
                           )) %>%
    plot_attr_reja_pval$add_colors(
      side = "both",
      upper = q975_x_means,
      lower = q025_x_means,
      test_stat = x_mean,
      mu0 = mu0
    )
  
  create_density_t_data <- function(x_range, mu0, sigma_g, df, labels, x_mean) {
    tibble(
      x = rep(x_range, 2),
      y = dt((x - mu0) / sigma_g, df) / sigma_g,
      plot_type = rep(
        labels,
        each = length(x_range)
      )
    ) %>%
      plot_attr_reja_pval$add_colors(
        side = "both",
        upper = qt(0.975, df) * sigma_g,
        lower = qt(0.025, df) * sigma_g,
        test_stat = x_mean,
        mu0 = mu0
      )
  }

  density_data <- bind_rows(
    create_density_t_data(
      x_range,
      mu0,
      s_t,
      df_t,
      c("t-Test p-Wert", "t-Test Ablehnungsbereich"),
      x_mean
    ),
    create_density_t_data(
      x_range,
      mu0,
      s_w,
      df_w,
      c("Welch-Test p-Wert", "Welch-Test Ablehnungsbereich"),
      x_mean
    )
  )
 
   plot_hist_curve_pval_reja <- ggplot() +
     geom_histogram(data = histogram_data,
                   aes(x = x, fill = color),
                   binwidth = binwidth)+
    geom_area(data = density_data, 
              aes(x = x, y = y, fill = color), stat = "identity") +
    geom_vline(xintercept = x_mean) +
    geom_text(
      data = bind_rows(
        create_text_data(
           str_c(round(100 * c(1 - p_value_emp, p_value_emp), 1), '%'),
          y_label_position_hist,
          "Histogram p-Wert"
        ),
        create_text_data(
          c('95%', '5%'), 
          y_label_position_hist,
          "Histogram Ablehnungsbereich"
        ),
        create_text_data(str_c(round(
          100 * c(1 - p_value_the_t, p_value_the_t), 1
        ), '%'), y_label_position_dens, "t-Test p-Wert"),
        create_text_data(c('95%', '5%'), y_label_position_dens, "t-Test Ablehnungsbereich"),
        create_text_data(str_c(round(
          100 * c(1 - p_value_the_w, p_value_the_w), 1
        ), '%'), y_label_position_dens, "Welch-Test p-Wert"),
        create_text_data(c('95%', '5%'), y_label_position_dens, "Welch-Test Ablehnungsbereich")
      ),
      mapping = aes(
        x = x,
        y = y,
        label = label,
        colour = color
      )
    ) +
    facet_wrap(
      ~ plot_type,
      ncol = 2,
      scales = "free_y",
      strip.position = "top"
    ) +
    line_xlim +
    plot_attr_reja_pval$theme +
    labs(x = str_c(var_name, "-Mittelwertdifferenz"), 
         y = "Wahrscheinlichkeitsdichte        Häufigkeit")
  
  return(mget(ls()))
}
exm_breakup <- gen_exm_t_welch(mu1 = 6.84,
                            s1 = 2.52,
                            n1 = 2695,
                            mu2 = 6.58,
                            s2 = 2.58,
                            n2 = 1409,
                            var_name = "ER",
                            x_min = -10,
                            x_max = 100,
                            file_name = '06-exm-breakup.sav',
                            group_labels = c('male', 'female'),
                            x_label_position = 0.2*c(-1,1),
                            y_label_position_hist = 250,
                            y_label_position_dens = 4,
                            binwidth = 0.02,
                            plot_bag = TRUE)
```

@morris2015 haben untersucht, ob das Geschlecht einen Einfluss auf den Schmerz bei der Auflösung einer romantischen Beziehung hat. Die Autoren unterscheiden dabei zwischen emotionaler (Angst, Wut, Depression, Taubheit, usw.) und physischer Reaktion (Essgewohnheit, Schlaf, Gewicht, Panik, Immunsystem). Hier wird nur auf erstere fokussiert, welche mit _ER_ abgekürzt wird. Dazu wurde mit erlösfreien Online-Umfragen unter anderem erfragt, ob die Person eine Trennung erlebt hat und wie sie ihren emotionalen Trennungsschmerz von $0$ (keine Schmerzen) bis $10$ (unerträglich) einstuft. An der Studie haben $N_\text{Frau} = `r exm_breakup$n1`$ Frauen und $N_\text{Mann} = `r exm_breakup$n2`$ Männer mitgemacht, welche eine ER von $M_\text{Frau} = `r round(exm_breakup$x1_mean,2)`, SD_\text{Frau} = `r round(exm_breakup$x1_sd,2)`$  und $M_\text{Mann} = `r round(exm_breakup$x2_mean,2)`, SD_\text{Mann} = `r round(exm_breakup$x2_sd,2)`$ respektive aufwiesen. 
:::

## Was ist das Problem der Stichprobenziehung?

In der Stichprobe kann also ein kleiner geschlechterspezifischer Mittelwertunterschied der ER beobachtet werden. Dieser Mittelwertunterschied könnte nun einerseits auf einen Mittelwertunterschied in der Population zurückzuführen sein, wie in Abbildung \@ref(fig:exm-breakup-bagplot) links dargestellt. Hier gibt es zwei Populationen: Frauen-Population  mit höheren und Männer-Population  mit tieferen ER-Werten. Dies führt dazu, dass der Erwartungswert der Frauen-Population höher ist als bei Männer-Population und eine zufällige gezogene Stichprobe aus Frauen-Population auch ein höheres arithmetisches Mittel aufweist als Männer-Population.

Andererseits könnte der Mittelwertunterschied auch auf die zufällige Stichprobenziehung zurückzuführen sein, siehe Abbildung \@ref(fig:exm-breakup-bagplot) rechts. In dieser Situation haben die Frauen- und die Männer-Populationen ähnliche Werte und demnach auch einen ähnlichen Erwartungswert. Beim Ziehen der Stichproben spielt der Zufall hier so, dass aus der Frauen-Population einige Beobachtungen mehr mit hohen ER-Werten ausgewählt wurden als bei der Männer-Population. Dies führt dazu, dass in den zwei Stichproben ein Unterschied im arithmetischen Mittel der ER beobachtet werden kann. 

```{r exm-breakup-bagplot, fig.cap="Links: Zwei Stichprobenziehungen aus zwei Populationen mit unterschiedlichen Mittelwerten. Rechts: Zwei Stichprobenziehungen aus einer Population, bzw. aus zwei Populationen die sich bezüglich ihrer Werte nicht unterscheiden."}
grid.arrange(exm_breakup$plot_ball_bag_different,
             exm_breakup$plot_ball_bag_same, 
             ncol = 2)
```

<!-- Discuss: welchen zwei anderen Möglichkeiten sind hier nicht dargestellt? -->

Welche dieser Situationen zutrifft kann nicht genau herausgefunden werden, da die Population nie vollständig beobachtet werden kann.

Um trotzdem eine Aussage über die Population zu treffen, kann wie bereits mehrmals gemacht, die Stichprobenziehung oft - beispielsweise $`r exm_breakup$n_samples`$-mal - wiederholt werden. Dies wird unter der Annahme gemacht, dass es keinen ER-Erwartungswertunterschied zwischen der Frauen- und Männer-Population gibt. Die Verteilung der ER-Mittelwertdifferenzen dieser Stichproben ist in Abbildung \@ref(fig:exm-breakup-hist) dargestellt. 

```{r exm-breakup-hist, fig.cap="Verteilung simulierter ER-Mittelwertdifferenzen bei wiederholten Zufallsstichprobenziehung. Rot: Annäherung der Verteilung mit dem Student t-Test; grün: Annäherung der Verteilung durch den Welch-Test."}
exm_breakup$plot_hist
```

Das Testprinzip funktioniert genau gleich wie beim $t$-Test für eine Stichprobe wie in Kapitel \@ref(zentrale-tendenz-testen). Zunächst werden die Hypothesen aufgestellt. A priori liegt keine Vermutung darüber vor, ob Männer oder Frauen eine stärkere ER zeigen. Die Null- und Alternativhypothese sind deshalb

> $H_0: \mu_\text{Frau} = \mu_\text{Mann}$
>
> $H_1: \mu_\text{Frau} \neq \mu_\text{Mann}.$

Dies entspricht, einfacher Arithmetik folgend, 

> $H_0: \mu_\text{Frau} - \mu_\text{Mann} = 0$
>
> $H_1: \mu_\text{Frau} - \mu_\text{Mann} \neq 0.$

Es kann beobachtet werden, dass, wenn es keine Erwartungswertdifferenz gibt, die Mittelwertdifferenzen der Stichproben am häufigsten bei $0$ liegen und mit zunehmender Entfernung von $0$ unwahrscheinlicher werden. Dies kann wieder formalisiert werden indem die $5\%$ unwahrscheinlichsten Werte ($2.5\%$ links und $2.5\%$ rechts) zum Ablehnungsbereich erklärt werden und entspricht der roten Fläche in Abbildung \@ref(fig:exm-breakup-hist-pval-reja) links. Die tatsächlich beobachtete Mittelwertdifferenz (schwarze Linie) liegt im Ablehnungsbereich. Dies bedeutet dass sich die Erwartungswertdifferenz bei Signifikanzniveau $5\%$ signifikant von $0$ unterscheidet. Dies ist äquivalent zu der Aussage, dass sich die ER-Erwartungswerte der Männer und Frauen signifikant unterscheidet.

```{r exm-breakup-hist-pval-reja, fig.cap="TODO"}
exm_breakup$plot_hist_curve_pval_reja
```

<!-- Discuss: warum ist p-Wert nur rechts? Es hat keine Beobachtungen kleiner als -0.237. -->

Ebenfalls kann erneut der p-Wert berechnet werden. Dieser entspricht hier allen ER-Mittelwertdifferenzen, welche _extremer_ als die beobachtete Mittelwertdifferenz $`r round(exm_breakup$x_mean,2)`$ sind. Da die Hypothesenstellung hier zweiseitig ist, bedeutet extremer hier wieder grösser als $`r round(exm_breakup$x_mean,2)`$ oder kleiner als $`r round(-exm_breakup$x_mean,2)`$. Der $p$-Wert entspricht dem Anteil der roten Fläche in Abbildung \@ref(fig:exm-breakup-hist-pval-reja) rechts an der Gesamtfläche und beträgt $`r round(exm_breakup$p_value_emp,3)`$.

Die Verteilung der Mittelwertdifferenzen unter der Annahme, dass die Nullhypothese wahr ist, kann wieder mit einer Kurve angenähert werden. Diese Annäherung hat den Vorteil, dass der Ablehnungsbereich und der $p$-Wert abgeschätzt werden kann, ohne dass dazu das Experiment wiederholt werden muss. Für die Annäherungskurve gibt es zwei Optionen, welche dann entsprechenden Tests ihre Namen geben: der Zweistichproben-$t$-Test nach Student und der Welch Test.

### Erwartungswertunterschied Zweistichproben-$t$-Test nach Student

[Der **Zweistichproben-$t$-Test** setzt voraus, dass die beiden Populationen eine ähnliche Varianz oder äquivalent eine ähnliche Standardabweichung haben.]{.customdef #customdef-twosample-t-test} Dazu später mehr. Ist dies gegeben, so kann die Teststatistik mit

\begin{equation}
t = \frac{\bar{x_1}-\bar{x_2} - \omega_0}{\sqrt{\frac{(n_1 - 1) s_1^2+(n_2-1)s_2^2}{n_1 + n_2 - 2}}\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}}
(\#eq:t-emp-twosample-t)
\end{equation}

<!-- Discuss formulas -->

berechnet werden, wobei $\omega_0 = \mu_1 - \mu_2$ der Erwartungswertdifferenz entspricht und in unserem Fall $0$ beträgt. Wenn die Nullhypothese wahr ist, so ist diese Teststatistik bei wiederholter Stichprobenziehung $t$-verteilt bei $df = n_1 + n_2 -2$ Freiheitsgraden.

Die rote Linie in Abbildung \@ref(fig:exm-breakup-hist) zeigt, dass die Annäherung durch den Zweistichproben-$t$-Test nach Student die Verteilung der Mittelwertdifferenzen ziemlich gut trifft.

<!-- Discuss, wieso ist die Verteilung gegen links verschoben. -->

### Erwartungswertunterschied Welch Test

:::{.example #emotional-stroop name="Emotionaler Stroop-Test bei posttraumatischer Belastungsstörung."}

```{r emotional-stroop}
exm_emotional_stroop <- gen_exm_t_welch(
  mu1 = 762.40,
  s1 = 232.93,
  n1 = 26,
  mu2 = 639.07,
  s2 = 94.90,
  n2 = 16,
  var_name = "RT",
  x_min = 0,
  x_max = 10000,
  file_name = '06-exm-emotional-stroop.sav',
  group_labels = c('PTSD', 'Non-PTSD'),
  x_label_position = 100*c(-1,1),
  y_label_position_hist = 250,
  y_label_position_dens = 0.005,
  binwidth = 15,
  plot_bag = FALSE
)
```

Analog zum klassischen Stroop-Test werden bei einem emotionalen Stroop-Test _EST_ Testpersonen gebeten die Farben verschiedener ausgeschriebener Wörter zu erkennen. Die Wörter sind beim emotionalen Stroop-Test entweder emotional aufgeladen (Bombe, Schweiss, Faustschlag, ...) oder neutral (Tisch, Weg, Bahn, ...) für die Testpersonen [@williams1996]. Gemessen wird dabei die Reaktionsgeschwindigkeit _RT_ in Millisekunden. In einem Versuch wollten @khanna2017 herausfinden, ob von posttraumatischer Belastungsstörung  betroffene Veteranen _PTSD_ andere EST-Resultate erzielen als nicht betroffene _non-PTSD_. Die durchschnittliche Reaktionszeit der $`r exm_emotional_stroop$n1`$ von PTSD betroffenen Veteranen lag bei $M=`r round(exm_emotional_stroop$x1_mean,1)`\text{ ms }(SD = `r round(exm_emotional_stroop$x1_sd,1)`)$ und bei den $`r exm_emotional_stroop$n2`$ nicht von PTSD betroffenen Veteranen bei $M=`r round(exm_emotional_stroop$x2_mean,1)` \text{ ms }(SD = `r round(exm_emotional_stroop$x2_sd,1)`)$.  

:::

Es wird keine Annahme über die Richtung einer eventualen Mittelwertdifferenz angenommen. Die Hypothesen sind deshalb zweiseitig formuliert und lauten

> $H_0: \mu_\text{PTSD} = \mu_\text{non-PTSD}$
>
> $H_1: \mu_\text{PTSD} \neq \mu_\text{non-PTSD}.$

In diesem Beispiel sind die Standardabweichungen und demnach auch die Varianzen der Reaktionszeiten in den beiden Gruppen sehr unterschiedlich. Wenn das Experiment wiederum wiederholt wird, kann der Verteilung der Mittelwertdifferenzen entnommen werden, dass der Zweistichproben-$t$-Test nach Student diese Verteilung nicht gut abbildet. Die rote Linie in Abbildung \@ref(fig:exm-emotional-stroop-hist) liegt mittig zu tief und an den Enden zu hoch. Wird diese Annäherung in diesem Fall verwendet, dann besteht die Gefahr, dass ein signifikanter Mittelwertunterschied nicht erkannt wird.

```{r exm-emotional-stroop-hist, fig.cap="Verteilung simulierter RT-Mittelwertdifferenzen bei wiederholten Zufallsstichprobenziehung. Rot: Annäherung der Verteilung mit dem Student t-Test; grün: Annäherung der Verteilung durch den Welch-Test."}
exm_breakup$plot_hist
```

Für diesen Fall wurde von @welch1947 eine alternative Annäherung an die Verteilung der Mittelwertdifferenzen gefunden, nämlich

\begin{equation}
t = \frac{\bar{x_1}-\bar{x_2} - \omega_0}{\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}}.
(\#eq:t-emp-twosample-welch)
\end{equation}

<!-- Discuss formulas -->

Die so berechnete Teststatistik $t$ ist $t$-Verteilt bei approximativ 
$$df \approx\frac{\left(\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}\right)^2}{\frac{s_1^4}{(n_1-1) n_1^2}+ \frac{s_2^4}{(n_2-1) n_2^2}}  $$

[Freiheitsgraden und ein damit durchgeführter Test wird **Welch-Test** genannt.]{.customdef #customdef-welch-test} Sie nähert die Verteilung der Mittelwertdifferenzen trotz unterschiedlicher Gruppenvarianzen gut an, siehe grüne Linie in Abbildung \@ref(fig:exm-emotional-stroop-hist). 

Der Zweistichproben-$t$-Test und der Welch-Test sind also zwei Testvarianten, um zu testen, ob der Erwartungswert in zwei Gruppen unterschiedlich ist. Dabei hat sich gezeigt, dass der Welch-Test die wahre Verteilung besser annähert als der Zweistichproben-$t$-Test, wenn die beiden Gruppen unterschiedliche Varianzen aufweisen, siehe Abbildung \@ref(fig:exm-emotional-stroop-hist). Wenn beide Varianzen ungefähr gleich sind, so geben beide Tests jedoch ähnlich gute Resultate, siehe Abbildung \@ref(fig:exm-breakup-hist). Es wird deshalb empfohlen immer den Welch-Test durchzuführen [@zimmerman2004]. Ein Vergleich der Abbildungen \@ref(fig:exm-breakup-hist-pval-reja) und \@ref(fig:exm-emotional-stroop-hist-pval-reja) zeigt auch, dass der Unterschied von Ablehnungsbereich und $p$-Wert beim im Falle der ähnlichen Varianzen gering und im Falle der unterschiedlichen Varianzen augenscheinlich wird.

<!-- Discuss: klären, Welch-Test praktisch relevant, zweistichproben-t-test historisch und als referenz wichtig. -->

```{r exm-emotional-stroop-hist-pval-reja, fig.cap="TODO"}
exm_emotional_stroop$plot_hist_curve_pval_reja
```

<!-- Discuss: rote und grüne linie auf den Histogramm plots -->

<!-- Discuss: what does it mean to have one sided hypothesis: distribution, histogram and hypothesis formulation -->

## Effektstärken

In den Fromeln \@ref(eq:t-emp-twosample-t) und \@ref(eq:t-emp-twosample-welch) kann beobachtet werden, dass mit zunehmenden Stichprobengrössen der Gruppen der Nenner immer kleiner und damit die Teststatistik $t$ für eine gleichbleibende Mittelwert differenz immer grösser wird. Dies bedeutet, dass auch kleine Mittelwertdifferenzen bei grossen Stichprobengrösse signifikanten - also nicht auf die zufällige Stichprobenziehung zurückzuführenden - Unterschied darstellen. Beim Trennungsschmerzbeispiel ist der Mittelwertunterschied von $`r round(exm_breakup$x_mean,2)`$ gering. Dies trotz dem $p$-Wert des Welch-Test von $p=`r round(exm_breakup$p_value_the_w,3) %>% str_sub(start = 2L)`$, welcher auf einen stark signifikanten Mittelwertunterschied hindeutet. Umgekehrt bei der posttraumatischen Belastungsstörung: Hier ist der Mittelwertunterschied mit $`r round(exm_emotional_stroop$x_mean)`$ ms substanziell, aber der $p$-Wert des Welch-Test von $p=`r round(exm_emotional_stroop$p_value_the_w,3) %>% str_sub(start = 2L)`$ deutet knapp auf keine signifikante Mittelwertdifferenz hin. 

Würde die Relevanz des beobachteten Effekts mit der Mittelwertsdifferenz gemessen, dann wäre, analog zu Kapitel \@ref(zentrale-tendenz-testen), dieses Mass wieder abhängig von der Einheit. Um dies zu verhindern, wird die Mittelwertdifferenz wieder durch die Standardabweichung geteilt. Für die konkrete Berechnung der Effektstärke gibt es verschiedene Methoden, wovon drei hier vorgestellt werden:

- [Bei **Cohens $d$ für Zweistichproben-t-Test** (Symbol $d$) wird die Mittelwertdifferenz durch das gewichtete Mittel der Standardabweichungen geteilt.]{.customdef #customdef-cohens-d} 
$$d = \frac{\bar{x_1}-\bar{x_2}}{\sqrt{\frac{(n_1 - 1) s_1^2+(n_2-1)s_2^2}{n_1 + n_2 - 2}}}$$
Diese Formel entpricht dem `Cohens d` für den Zweistichproben-$t$-Test in `Jamovi`.
<!-- Discuss difference to effect size for only one sample t test. -->
- [Bei **Hedges $g$** (Symbol $g$) handelt es sich um eine um einen Faktor korrigierte Version von Cohens $d$ für den Zweistichproben-$t$-Test.]{.customdef #customdef-hedges-g} 
$$g = \left(1-\frac{3}{4(n_1+n_2)-9}\right)d$$
Hedges $g$ ist genauer als Cohens $d$ bei kleinen Stichprobengrössen und gleich wie Cohens $d$ für grosse Stichproben. Es kann daher immer Hedges $g$ verwendet werden. Diese Formel wird für den Zweistichproben-$t$-Test verwendet und ist besser geeignet als $d$ oben - ein Unterschied ist jedoch nur bei kleinen Stichproben ersichtlich. Hedges $g$ wird in `Jamovi` nicht standardmässig ausgegeben und muss händisch berechnet werden.
- [Bei **Cohens $d$ für den Welch-Test** (Symbol $d$) wird die Mittelwertdifferenz durch die mittlere Standardabweichungen geteilt.]{.customdef #customdef-welch-cohens-d} 
$$d = \frac{\bar{x_1}-\bar{x_2}}{\sqrt{\frac{s_1^2+s_2^2}{2}}}$$
Diese Formel entpricht dem `Cohens d` für den Welch-Test in `Jamovi`.
- [**Glass $\Delta$** (gr. delta, Symbol $\Delta$) wir nur bei Experimenten verwendet. Dabei wird die Mittelwertdifferenz durch die Standardabweichung der Kontrollgruppe dividiert, weil angenommen wird, dass die Kontrollgruppe repräsentativer für die Popoulation ist.]{.customdef #customdef-glass-delta}
$$\Delta = \frac{\bar{x}_\text{Experiment}-\bar{x}_\text{Kontroll}}{s_\text{Kontroll}}$$
Glass $\Delta$ wird in `Jamovi` nicht standardmässig ausgegeben und muss händisch berechnet werden. 

Da es sich bei beiden Beispielen nicht um Experimente handelt, weil weder das Geschlecht noch die posttraumatische Belastungsstörung zufällig zugeorndet wurde, ist hier Glass $\Delta$ keine sinnvolle Effektgrösse. Aus diesem Grund wird für die Effektstärkenberechnung bei beiden Beispielen Cohens $d$ für den Welch-Test verwendet. Das berichten der Testresultate kann deshalb wie folgt aussehen:

> Ein zweiseitiger Welch-Test ergibt, dass die durchschnittliche emotionale Antwort ER bei einer Trennung  bei Männern ($M = `r round(exm_breakup$jmv_res_desc$mean1,2)`$, $SD = `r round(exm_breakup$jmv_res_desc$sd1,2)`$, $N = `r exm_breakup$jmv_res_desc$num1`$) signifikant anders ist als bei Frauen ($M = `r round(exm_breakup$jmv_res_desc$mean2,2)`$, $SD = `r round(exm_breakup$jmv_res_desc$sd2,2)`$, $N = `r exm_breakup$jmv_res_desc$num2`$), $t(`r round(exm_breakup$jmv_res_test$dfwelc,1)`) = `r round(exm_breakup$jmv_res_test$statwelc,2)`$, $`r report_p(exm_breakup$jmv_res_test$pwelc)`, d = `r round(exm_breakup$jmv_res_test$eswelc,2)`$.

> Ein zweiseitiger Welch-Test ergibt, dass die durchschnittliche Reaktionszeit beim emotionalen Stroop-Test bei Veteranen ohne PTSD ($M = `r round(exm_emotional_stroop$jmv_res_desc$mean1,2)`$, $SD = `r round(exm_emotional_stroop$jmv_res_desc$sd1,2)`$, $N = `r exm_emotional_stroop$jmv_res_desc$num1`$) nicht signifikant anders ist als bei Menschen mit PTSD ($M = `r round(exm_emotional_stroop$jmv_res_desc$mean2,2)`$, $SD = `r round(exm_emotional_stroop$jmv_res_desc$sd2,2)`$, $N = `r exm_emotional_stroop$jmv_res_desc$num2`$), $t(`r round(exm_emotional_stroop$jmv_res_test$dfwelc,1)`) = `r round(exm_emotional_stroop$jmv_res_test$statwelc,2)`$, $`r report_p(exm_emotional_stroop$jmv_res_test$pwelc)`, d = `r round(exm_breakup$jmv_res_test$eswelc,3)`$.

<!-- g = `r round((1-(3/(4*(exm_emotional_stroop$n1+exm_emotional_stroop$n2)-9)))*exm_emotional_stroop$jmv_res_test$esstud,3)`. -->

<!-- mit der neuen Trainingsmethode ist nicht signifikant tiefer als $`r exr_schwimmen$mu0`$ Minuten, $t(`r exr_schwimmen$jmv_res_test$df`) = `r round(exr_schwimmen$jmv_res_test$stat,2)`$, $p = `r round(exr_schwimmen$jmv_res_test$p,3) %>% str_sub(start = 2L)`, d = `r round(exr_schwimmen$jmv_res_test$es,3)`$. -->

Beim Trennungsschmerz handelt es sich um einen schwachen, bei der Reaktionszeit auf den EST um einen mittleren Effekt.

<!-- Discuss: Interpretation. -->

::::{.caution data-latex=""}

::: {.remark}
- Die Namensgebung von diesen Berechnungsarten und insbesondere, was unter Cohens $d$ verstanden wird variiert beträchtlich und es empfiehlt sich immer die genaue Berechnungsart zu überprüfen.
<!-- Discuss: Entwirrung Enzmann 2015 -->
- In `Jamovi` wird für den Zweistichproben-$t$-Test und den Welch-Test eine unterschiedliche Effektstärke angegeben.
<!-- pooledVARSTUD <- tryNaN(((n[1]-1)*v[1]+(n[2]-1)*v[2])/(n[1]+n[2]-2)) -->
<!-- pooledVARWELC <- tryNaN((v[1] + v[2]) / 2) -->
<!-- sediffSTUD <- tryNaN(sqrt((pooledVARSTUD/n[1])+(pooledVARSTUD/n[2]))) -->
<!-- sediffWELC <- tryNaN(sqrt((v[1]/n[1])+(v[2]/n[2]))) -->

<!-- dSTUD <- (m[1]-m[2])/sqrt(pooledVARSTUD) # Cohen's d for student's t -->
<!-- dWELC <- (m[1]-m[2])/sqrt(pooledVARWELC) # Cohen's d for Welch's t -->
:::

::::





## Übungen

::: {.exercise  #bobo2groups}
<!-- 
Ziel: 
- Anwendung t-Test mit Jamovi zweiseitig
-->

```{r exr-bobo2groups}
gen_exr_bobo2groups <- function(){
  set.seed(23)
  n1 <- 24
  n2 <- 24
  x1 <- rnorm(n1, 10, 3)
  x2 <- rnorm(n2, 5, 0.5)
  var_name <- "anzahl_aggressionen"
  group_labels <- c('aggressiv', 'nicht aggressiv')
  
  file_name <- '06-exr-bobo2groups.sav'
  dd <- tibble(!!var_name := c(x1, x2),
       Gruppe = c(rep(group_labels[1],n1), 
                  rep(group_labels[2], n2))) %>% 
  write_sav(file_name)

  jmv_res <- dd %>%
    jmv::ttestIS(formula = as.formula(str_c(var_name, "~Gruppe")),
                desc = TRUE,
                 welchs = TRUE, 
                 mann = FALSE, 
                 effectSize = TRUE)
  jmv_res_test <- jmv_res$ttest$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(stud|welc)\\]',"\\1"))
  jmv_res_desc <- jmv_res$desc$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(1|2)\\]',"\\1"))
  
  return(mget(ls()))
}
exr_bobo2groups <- gen_exr_bobo2groups()
```

Mit dem Bobo-Doll-Experiment sollte die Übertragung von Aggression durch Imitation aggressiver Modelle nachgewiesen werden. An der Studie nahmen $`r exr_bobo2groups$n1 + exr_bobo2groups$n2`$ Kinder im Alter von drei bis sechs Jahren teil. Die Kinder wurden in zwei Gruppen eingeteilt: eine mit aggressivem Modell und eine mit nicht-aggressivem Modell. In der aggressiven Bedingung sahen die Kinder, wie eine erwachsene Person (das Modell) eine Bobo-Puppe aggressiv behandelte, während in der nicht-aggressiven Bedingung das Modell ruhig mit der Puppe spielte. Nach der Beobachtungsphase wurden die Kinder einzeln in einen Spielraum geführt, der ähnliche Spielzeuge wie im Experiment enthielt, einschliesslich der Bobo-Puppe. Die Forscher beobachteten und notierten die Anzahl gezeigter aggressiven Handlungen gegenüber der Bobo-Puppe. 
Inspiriert von @bandura1961.

Beantworten Sie die Frage, ob aggressives Verhalten Erwachsener von Kindern imitiert wird anhand der folgenden Teilfragen:

a) Die Kinder welcher Gruppe zeigen ein aggressiveres Verhalten? Argumentieren Sie mit zahlen.
b) Kann die Aussage aus a) von der Stichprobe auf die Population verallgemeinert werden? Stellen Sie zweiseitige Testhypothesen für den Erwartungswert auf.
c) Führen Sie den statistischen Test mit Jamovi durch und berechnen Sie eine angemessene Effektstärke. Berichten und interpretieren Sie das Testresultat.
:::

:::{.solution}
Zuerst wird der Datensatz mit `Jamovi` eingelesen und die Analyseparameter werden gesetzt, siehe Abbildung \@ref(fig:sol-bobo2groups-input). 

```{r sol-bobo2groups-input, out.width='100%', fig.cap='Jamovi Eingabe.'}
knitr::include_graphics("figures/06-exr-bobo2groups-jmv-input.jpg")
```

Dies produziert das Analyseergebnis in Abbildung \@ref(fig:sol-bobo2groups-output).

```{r sol-bobo2groups-output, out.width='100%', fig.cap='Jamovi Ausgabe.'}
knitr::include_graphics("figures/06-exr-bobo2groups-jmv-output.jpg")
```

Damit können und beide Teilfragen beantwortet werden. 

a) In der Stichprobe ist der durchschnittliche Anzahl gezählter Aggressionen in der Gruppe mit aggressiven Modellen mit $M = `r round(exr_bobo2groups$jmv_res_desc$mean1,2)`$ höher als in der Gruppe mit nicht Aggressiven Modellen $M = `r round(exr_bobo2groups$jmv_res_desc$mean2,2)`$. Es könnte sein, dass der gefundene Mittelwertunterschied auf die zufällige Stichprobenziehung zurückzuführen ist. Um dieses Risiko zu quantifizieren und damit einzuschätzen, ob das Ergebnis auch für die Population gelten könnte, kann ein statistischer Test durchgeführt werden.
b) Es soll gezeigt werden, dass sich der durchschnittlich beobachtete Anzahl aggressiver Handlungen der Kinder in der Gruppe mit aggressivem Modell anders ist als in der Gruppe mit nicht aggressivem Modell. Die Alternativhypothese lautet also $H_1: \mu_\text{Aggressiv} \neq \mu_\text{Nicht aggressiv}$. Die Nullhypothese dagegen sagt, dass beide Gruppen durchschnittlich gleich viele aggressive Handlungen begehen, also $H_0: \mu_\text{Aggressiv} = \mu_\text{Nicht aggressiv}$.
c) Es werden Mittelwerte von einer intervallskalierten Variabel über zwei Gruppen verglichen. Als statischer Test kommt demnach der Zweistichproben-$t$-Test oder der Welch-Test infrage. Aufgrund der genaueren Testergebnisse wird immer der Welch-Test bevorzugt und dieser in folge durchgeführt und berichtet. Ein zweiseitiger Welch-Test ergibt, dass der durchschnittliche Anzahl Aggressionen in der Gruppe mit aggressivem Modell ($M = `r round(exr_bobo2groups$jmv_res_desc$mean1,2)`$, $SD = `r round(exr_bobo2groups$jmv_res_desc$sd1,2)`$, $N = `r exr_bobo2groups$jmv_res_desc$num1`$) signifikant anders ist als in der Gruppe mit nicht aggressivem Modell ($M = `r round(exr_bobo2groups$jmv_res_desc$mean2,2)`$, $SD = `r round(exr_bobo2groups$jmv_res_desc$sd2,2)`$, $N = `r exr_bobo2groups$jmv_res_desc$num2`$), $t(`r round(exr_bobo2groups$jmv_res_test$dfwelc,1)`) = `r round(exr_bobo2groups$jmv_res_test$statwelc,2)`$, $`r report_p(exr_bobo2groups$jmv_res_test$pwelc)`, \Delta = `r round(glass_delta(exr_bobo2groups$jmv_res_desc, TRUE),3)`$. Da es sich um ein Experiment handelt ist hier die Effektstärke Glass $\Delta$ angebracht. Die Effektstärke ist als gross einzustufen. 
:::

::: {.exercise  #gruppenpuzzle}
<!-- 
Ziel: 
- Anwendung t-Test mit Jamovi zweiseitig
-->
```{r exr-gruppenpuzzle}
gen_exr_gruppenpuzzle <- function(){
  set.seed(23)
  n1 <- 35
  n2 <- 21
  x1 <- rnorm(n1, 5.1, 0.3)
  x2 <- rnorm(n2, 4.8, 0.3)
  var_name <- "Zuneigung"
  group_labels <- c('gruppenpuzzle', 'traditionell')
  
  file_name <- '06-exr-gruppenpuzzle.sav'
  dd <- tibble(!!var_name := c(x1, x2),
       Gruppe = c(rep(group_labels[1],n1), 
                  rep(group_labels[2], n2))) %>% 
  write_sav(file_name)

  jmv_res <- dd %>%
    jmv::ttestIS(formula = as.formula(str_c(var_name, "~Gruppe")),
                desc = TRUE,
                 welchs = TRUE, 
                 mann = FALSE, 
                 effectSize = TRUE)
  jmv_res_test <- jmv_res$ttest$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(stud|welc)\\]',"\\1"))
  jmv_res_desc <- jmv_res$desc$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(1|2)\\]',"\\1"))
  
  return(mget(ls()))
}
exr_gruppenpuzzle <- gen_exr_gruppenpuzzle()
```

In den 1970er Jahren hat eine Gruppe um @blaney1977 Versuche durchgeführt zu neuen Lehrmethoden. Insbesondere wurde dabei das sogenannte Gruppenpuzzle `gruppenpuzzle`, eine Lernform bei welcher die Lernenden den Inhalt mit und in Abhängigkeit voneinander erarbeiten, mit dem traditionellen Frontalunterricht `traditionell` verglichen. Die Forschenden wollten unter anderem Herausfinden, ob sich die Gruppenpuzzleteilnehmende nach dem Unterricht besser mochten (_liking_), als traditionell unterrichtete Lernende. Fiktive Daten zu dem Experiment sind als `r inline_code(exr_gruppenpuzzle$file_name)` verfügbar.

a) Stellen Sie die Testhypothesen auf für einen zweiseitigen Welch-Test.
b) Führen Sie den Test durch und berichten Sie das Resultat.
c) Erklären Sie den Wert der Statistik, der Freiheitsgrade, des $p$-Werts und der Effektstärke respektive.
:::

:::{.solution}
Zuerst wird der Datensatz mit `Jamovi` eingelesen und die Analyseparameter werden gesetzt, siehe Abbildung \@ref(fig:sol-gruppenpuzzle-input). 

```{r sol-gruppenpuzzle-input, out.width='100%', fig.cap='Jamovi Eingabe.'}
knitr::include_graphics("figures/06-exr-gruppenpuzzle-jmv-input.jpg")
```

Dies produziert das Analyseergebnis in Abbildung \@ref(fig:sol-gruppenpuzzle-output).

```{r sol-gruppenpuzzle-output, out.width='100%', fig.cap='Jamovi Ausgabe.'}
knitr::include_graphics("figures/06-exr-gruppenpuzzle-jmv-output.jpg")
```

Damit können und die Teilfragen beantwortet werden. 

a) Angenommen die Zuneigung zur Personen der einen Gruppe ist unabhängig von der Lehrmethode, dann sollten beide Gruppen im durchschnitt denselben Erwartungswert $\mu$ bei der Zuneigung haben. Die Nullhypothese ist also $H_0: \mu_\text{Gruppenpuzzle} = \mu_\text{Traditionell}$. Ein Unterschied dazu wäre, wenn es die Lernenden der beiden Gruppen einen unterschiedlichen Erwartungswert aufweisen, formell $H_1: \mu_\text{Gruppenpuzzle} \neq \mu_\text{Traditionell}$. 
b) Ein zweiseitiger Welch-Test ergibt, dass die durchschnittliche Zuneigung in der Gruppenpuzzlegruppe ($M = `r round(exr_gruppenpuzzle$jmv_res_desc$mean1,2)`$, $SD = `r round(exr_gruppenpuzzle$jmv_res_desc$sd1,2)`$, $N = `r exr_gruppenpuzzle$jmv_res_desc$num1`$) signifikant anders ist als in der traditionell unterrichteten Gruppe($M = `r round(exr_gruppenpuzzle$jmv_res_desc$mean2,2)`$, $SD = `r round(exr_gruppenpuzzle$jmv_res_desc$sd2,2)`$, $N = `r exr_gruppenpuzzle$jmv_res_desc$num2`$), $t(`r round(exr_gruppenpuzzle$jmv_res_test$dfwelc,1)`) = `r round(exr_gruppenpuzzle$jmv_res_test$statwelc,2)`$, $`r report_p(exr_gruppenpuzzle$jmv_res_test$pwelc)`, \Delta = `r round(glass_delta(exr_gruppenpuzzle$jmv_res_desc, TRUE),3)`$.
c) Die Statistik von $`r round(exr_gruppenpuzzle$jmv_res_test$statwelc,2)`$ ist ein Wert, welcher eine Verteilung wie in \@ref(fig:t-distribution) aufweist. Diese Verteilung weist  die Statistik auf, wenn das Experiment oft wiederholt wird und die Nullhypothese wahr ist. Die Verteilung zweigt, dass der beobachtete Wert $`r round(exr_gruppenpuzzle$jmv_res_test$statwelc,2)`$ selten zufällig vorkommt (tiefer Wert der Linie weist auf eine tiefe Wahrscheinlichkeit der Statistik hin). Die Freiheitsgrade `r round(exr_gruppenpuzzle$jmv_res_test$dfwelc,1)` bestimmen die Form der oben referenzierten Verteilung. Wo bei kleinen Freiheitsgraden die beobachtete Statistik noch mit einer nicht allzukleinen Wahrscheinlichkeit beobachtet werden kann (vgl. $df = 1$ in der Abbildung), so ist es bei dieser Anzahl Freiheitsgrade sehr selten (vgl. `Normalverteilung` in der Abbildung). $`r report_p(exr_gruppenpuzzle$jmv_res_test$pwelc)`$ bedeutet, dass der $p$-Wert kleiner als $0.001 = 0.1\%$ ist. Damit ist die Wahrscheinlichkeit den Statistik-Wert $`r round(exr_gruppenpuzzle$jmv_res_test$statwelc,2)`$ oder einen extremeren Wert im Sinne der Alternativhypothese zu beobachten, gegeben dass die Nullhypothese wahr ist, kleiner als $0.1\%$ also sehr selten. Da der $p$-Wert kleiner ist als $5\%$ ist wird geschlossen, dass die Annahme, dass die Nullhypothese wahr ist, wahrscheinlich falsch ist. Die Effektstärke von $\Delta = `r round(glass_delta(exr_gruppenpuzzle$jmv_res_desc, TRUE),3)`$ bedeutet, dass hier ein Mittelwertunterschied von ungefähr $`r round(glass_delta(exr_gruppenpuzzle$jmv_res_desc, TRUE),3)`$ Standardabweichungen des Merkmals Zuneigung entspricht. Dies heisst, auf der Skala des Merkmals ist der Mittelwertunterschied gross oder anders gesagt: es handelt sich um einen starken Effekt. Das Vorzeichen hängt von der Gruppenbeschriftung ab und hat keine spezielle Bedeutung.
:::

::: {.exercise  #music-memory}
<!-- 
Ziel: 
- Zweiseitig nicht signifikant
-->
```{r exr-music-memory}
gen_exr_music_memory <- function(){
  set.seed(23)
  n2 <- 43
  n1 <- 35
  x2 <- rnorm(n1, 8.2, 0.9)
  x1 <- rnorm(n2, 8.0, 1.7)
  var_name <- "anzahl_nonsens_silben"
  group_labels <- c('mit_text', 'ohne_text')
  
  file_name <- '06-exr-music-memory.sav'
  dd <- tibble(!!var_name := c(x1, x2),
       Gruppe = c(rep(group_labels[1],n1), 
                  rep(group_labels[2], n2))) %>% 
  write_sav(file_name)

  jmv_res <- dd %>%
    jmv::ttestIS(formula = as.formula(str_c(var_name, "~Gruppe")),
                desc = TRUE,
                 welchs = TRUE, 
                 mann = FALSE, 
                 effectSize = TRUE)
  jmv_res_test <- jmv_res$ttest$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(stud|welc)\\]',"\\1"))
  jmv_res_desc <- jmv_res$desc$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(1|2)\\]',"\\1"))
  
  return(mget(ls()))
}
exr_music_memory <- gen_exr_music_memory()
```

Studierende wollen herausfinden, ob Entspannungsmusik ohne Text oder Musik mit Text einen unterschiedlichen Einfluss auf die Merkfähigkeit haben. Dazu lernen die Studienteilnehmenden während $10$ Minuten Wortsilben ohne semantische Bedeutung auswendig und geben diese nach einer Latenzzeit wider. Die Beschallungsart wird den Studienteilnehmenden zufällig zugeordnet. Die Anzahl korrekt memorisierte Wortsilben sind im Datensatz `r inline_code(exr_music_memory$file_name)` verfügbar.

a) Stellen Sie die Testhypothesen auf für einen zweiseitigen Welch-Test.
b) Führen Sie den Test durch und berichten Sie das Resultat.
c) Erklären Sie den Wert der Statistik, des $p$-Werts und der Effektstärke respektive.
:::

:::{.solution}
Zuerst wird der Datensatz mit `Jamovi` eingelesen und die Analyseparameter werden gesetzt, siehe Abbildung \@ref(fig:sol-music-memory-input). 

```{r sol-music-memory-input, out.width='100%', fig.cap='Jamovi Eingabe.'}
knitr::include_graphics("figures/06-exr-music-memory-jmv-input.jpg")
```

Dies produziert das Analyseergebnis in Abbildung \@ref(fig:sol-music-memory-output).

```{r sol-music-memory-output, out.width='100%', fig.cap='Jamovi Ausgabe.'}
knitr::include_graphics("figures/06-exr-music-memory-jmv-output.jpg")
```

Damit können die Teilfragen beantwortet werden. 

a) Die Nullhypothese besagt, dass die durchschnittliche Anzahl gemerkter Wortsilben beim Lernen mit oder ohne Musik gleich ist, also $H_0: \mu_\text{Musik mit Text} = \mu_\text{Musik ohne Text}$. Die Alternativhypothese besagt, dass sich die durchschnittliche Anzahl gemerkter Wortsiblen mit oder ohne Musik unterscheiden  $H_1: \mu_\text{Musik mit Text} \neq \mu_\text{Musik ohne Text}$. 
b) Ein zweiseitiger Welch-Test ergibt, dass die durchschnittliche Anzahl gemerkter Wortsilben beim Lernen mit Musik mit Text ($M = `r round(exr_music_memory$jmv_res_desc$mean1,2)`$, $SD = `r round(exr_music_memory$jmv_res_desc$sd1,2)`$, $N = `r exr_music_memory$jmv_res_desc$num1`$) nicht signifikant anders ist als beim Lernen mit Musik ohne Text ($M = `r round(exr_music_memory$jmv_res_desc$mean2,2)`$, $SD = `r round(exr_music_memory$jmv_res_desc$sd2,2)`$, $N = `r exr_music_memory$jmv_res_desc$num2`$), $t(`r round(exr_music_memory$jmv_res_test$dfwelc,1)`) = `r round(exr_music_memory$jmv_res_test$statwelc,2)`$, $`r report_p(exr_music_memory$jmv_res_test$pwelc)`, d = `r round(exr_music_memory$jmv_res_test$eswelc,3)`$.
c) Die Statistik von $`r round(exr_music_memory$jmv_res_test$statwelc,2)`$ ist ein Wert, welcher eine Verteilung wie in \@ref(fig:t-distribution) aufweist. Diese Verteilung weist  die Statistik auf, wenn das Experiment oft wiederholt wird und die Nullhypothese wahr ist. Die Verteilung zeigt, dass der beobachtete Wert $`r round(exr_music_memory$jmv_res_test$statwelc,2)`$ oft zufällig vorkommt (hoher Wert der Linie weist auf eine hohe Wahrscheinlichkeit der Statistik hin). $`r report_p(exr_music_memory$jmv_res_test$pwelc)`$ bedeutet, dass die Wahrscheinlichkeit den Statistik-Wert $`r round(exr_music_memory$jmv_res_test$statwelc,2)`$ oder einen extremeren Wert im Sinne der Alternativhypothese zu beobachten, gegeben dass die Nullhypothese wahr ist, nicht aussergewönlich erscheint. Da der $p$-Wert grösser ist als $5\%$ ist, kann keine Aussage zur Wahrheit oder Falschheit der Nullhypothese getroffen werden. Die Effektstärke von $d = `r round(exr_music_memory$jmv_res_test$eswelc,3)`$ bedeutet, dass hier ein Mittelwertunterschied von ungefähr $`r round(exr_music_memory$jmv_res_test$eswelc,3)`$ Standardabweichungen des Merkmals Anzahl gemerkter Wortsiblen entspricht. Dies heisst, auf der Skala des Merkmals ist der Mittelwertunterschied klein oder anders gesagt: es handelt sich um einen schwachen Effekt. Das Vorzeichen hängt von der Gruppenbeschriftung ab und hat keine spezielle Bedeutung.
:::

::: {.exercise  #hypnose}
<!-- 
Ziel: 
- Anwendung t-Test mit Jamovi linksseitig
-->

```{r exr-hypnose}
gen_exr_hypnose <- function(){
  set.seed(23)
  n2 <- 15
  n1 <- 11
  x2 <- rnorm(n1, 5.5, 1)
  x1 <- rnorm(n2, 5, 0.5)
  var_name <- "Schmerz"
  group_labels <- c('hypnose', 'placebo')
  
  file_name <- '06-exr-hypnose.sav'
  dd <- tibble(!!var_name := c(x1, x2),
       Gruppe = c(rep(group_labels[1],n1), 
                  rep(group_labels[2], n2))) %>% 
  write_sav(file_name)

  jmv_res <- dd %>%
    jmv::ttestIS(formula = as.formula(str_c(var_name, "~Gruppe")),
                 hypothesis = 'twoGreater',
                desc = TRUE,
                 welchs = TRUE, 
                 mann = FALSE, 
                 effectSize = TRUE)
  jmv_res_test <- jmv_res$ttest$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(stud|welc)\\]',"\\1"))
  jmv_res_desc <- jmv_res$desc$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(1|2)\\]',"\\1"))
  
  return(mget(ls()))
}
exr_hypnose <- gen_exr_hypnose()
```

Die Gesellschaft für Hypnose will unter Beweis stellen (Signifikanzniveau $\alpha=5\%$), dass ein neues Hypnoseverfahren eine schmerzlindernde Wirkung hat. Dazu werden Probanden zufällig und doppelblind in zwei Gruppen eingeteilt. Eine Gruppe erhält die Behandlung mit dem neuen Hypnoseverfahren, die andere wird einer Placebo-Behandlung unterzogen. Nach der Behandlung wird das Schmerzempfinden auf einer Skala von $1$ bis $10$ gemessen. Die Daten beider Versuchsgruppen stellen sich als normalverteilt heraus. Die erhobenen Daten sind unter `r inline_code(exr_hypnose$file_name)` abgelegt.

a) Beschreiben Sie die beiden Stichproben deskriptiv. Hat die neue Behandlungsmethode einen Vorteil gegenüber der Placebo-Behandlung in der Stichprobe? Weshalb ist es sinnvoll danach noch einen statistischen Test durchzuführen?
b) Stellen Sie die Hypothesen für einen einseitigen Test auf.
c) Prüfen Sie die Hypothesen mit einem geeigneten einseitig durchgeführten statistischen Test, ob das Resultat auch auf die Population übertragen werden kann. Berichten Sie das Ergebnis.
:::

:::{.solution}

Zuerst wird der Datensatz mit `Jamovi` eingelesen und die Analyseparameter werden gesetzt, siehe Abbildung \@ref(fig:sol-hypnose-input). 

```{r sol-hypnose-input, out.width='100%', fig.cap='Jamovi Eingabe.'}
knitr::include_graphics("figures/06-exr-hypnose-jmv-input.jpg")
```

Dies produziert das Analyseergebnis in Abbildung \@ref(fig:sol-hypnose-output).

```{r sol-hypnose-output, out.width='100%', fig.cap='Jamovi Ausgabe.'}
knitr::include_graphics("figures/06-exr-hypnose-jmv-output.jpg")
```

Damit können und beide Teilfragen beantwortet werden. 

a) In der Stichprobe ist der durchschnittliche Schmerz (arithmetisches Mittel) in der Hypnose-Gruppe mit $M = `r round(exr_hypnose$jmv_res_desc$mean2,2)`$ tiefer als in der Placebo-Gruppe mit $M = `r round(exr_hypnose$jmv_res_desc$mean1,2)`$. Es könnte sein, dass der gefundene Mittelwertunterschied auf die zufällige Stichprobenziehung zurückzuführen ist. Um dieses Risiko zu quantifizieren und damit einzuschätzen, ob das Ergebnis auch für die Population gelten könnte, kann ein statistischer Test durchgeführt werden.
b) Es soll gezeigt werden, dass sich der durchschnittlich empfundene Schmerz mit der Hypnose-Behandlung tiefer liegt als mit der Placebo-Behandlung. Die Alternativhypothese lautet also $H_1: \mu_\text{Hypnose} < \mu_\text{Placebo}$. Die Nullhypothese dagegen sagt, dass die Hypnose-Behandlung nicht besser oder sogar schlechter ist als die Placebo-Behandlung also $H_0: \mu_\text{Hypnose} \geq \mu_\text{Placebo}$.
c) Ein einseitiger Welch-Test ergibt, dass der durchschnittliche erhobene Schmerz bei einer Behandlung mit der neuen Hypnose-Methode ($M = `r round(exr_hypnose$jmv_res_desc$mean1,2)`$, $SD = `r round(exr_hypnose$jmv_res_desc$sd1,2)`$, $N = `r exr_hypnose$jmv_res_desc$num1`$) signifikant tiefer ist als bei der Placebo-Behandlung ($M = `r round(exr_hypnose$jmv_res_desc$mean2,2)`$, $SD = `r round(exr_hypnose$jmv_res_desc$sd2,2)`$, $N = `r exr_hypnose$jmv_res_desc$num2`$), $t(`r round(exr_hypnose$jmv_res_test$dfwelc,1)`) = `r round(exr_hypnose$jmv_res_test$statwelc,2)`$, $`r report_p(exr_hypnose$jmv_res_test$pwelc)`, \Delta = `r round(glass_delta(exr_hypnose$jmv_res_desc, TRUE),3)`$.
:::

::: {.exercise  #ehe-burnout}
<!-- 
Ziel: 
- Anwendung t-Test mit Jamovi rechtsseitig
-->
```{r exr-ehe-burnout}
gen_exr_ehe_burnout <- function(){
  set.seed(23)
  n1 <- 51L
  n2 <- 61L
  x1 <- rnorm(n1, 10.82, 2.165)
  x2 <- rnorm(n2, 10.08, 1.969)
  var_name <- "Burnout_score"
  group_labels <- c('Unverheiratet', 'Verheiratet')
  
  file_name <- '06-exr-ehe-burnout.sav'
  dd <- tibble(!!var_name := c(x1, x2),
       Gruppe = c(rep(group_labels[1], length(x1)), 
                  rep(group_labels[2], length(x2)))) %>% 
  write_sav(file_name)

  jmv_res <- dd %>%
    jmv::ttestIS(formula = as.formula(str_c(var_name, "~Gruppe")),
                 hypothesis = 'oneGreater',
                desc = TRUE,
                 welchs = TRUE, 
                 mann = FALSE, 
                 effectSize = TRUE)
  jmv_res_test <- jmv_res$ttest$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(stud|welc)\\]',"\\1"))
  jmv_res_desc <- jmv_res$desc$asDF%>% 
    rename_with(~ .x %>% str_replace_all('\\[(1|2)\\]',"\\1"))
  
  return(mget(ls()))
}
exr_ehe_burnout <- gen_exr_ehe_burnout()
```

Eine Forscherin hat die Hypothese, dass unverheiratete Ärztinnen ein weniger stabiles Umfeld haben als ihre verheirateten Kolleginnen. Das Fehlen dieser Ressource führt dazu, dass unverheiratete Ärztinnen eher Burnout gefährdet sind. Um diese Hypothese zu untersuchen befragt die Forscherin in einer Umfrage zufällig verheiratete und unverheiratete Ärztinnen. Diese füllen einen Online-Fragebogen mit einem Burnout-Inventar aus, welches zu einem Burnout-score führt. Die Daten sind unter `r inline_code(exr_ehe_burnout$file_name)` verfügbar.

a) Wie viele verheiratete und unverheiratete haben den Fragebogen abgeschlossen?
b) Welche Gruppe hat in der Stichprobe ein höheres mittleres Burnout-Risiko?
c) Übersetzen Sie die Hypothese der Forscherin in eine Statistische Hypothese.
d) Lässt sich die Hypothese statistisch bestätigen? Berichten Sie das Testresultat.
:::

:::{.solution}

Zuerst wird der Datensatz mit `Jamovi` eingelesen und die Analyseparameter werden gesetzt, siehe Abbildung \@ref(fig:sol-ehe-burnout-input). 

```{r sol-ehe-burnout-input, out.width='100%', fig.cap='Jamovi Eingabe.'}
knitr::include_graphics("figures/06-exr-ehe-burnout-jmv-input.jpg")
```

Dies produziert das Analyseergebnis in Abbildung \@ref(fig:sol-ehe-burnout-output).

```{r sol-ehe-burnout-output, out.width='100%', fig.cap='Jamovi Ausgabe.'}
knitr::include_graphics("figures/06-exr-ehe-burnout-jmv-output.jpg")
```

Damit können die Teilfragen beantwortet werden. 

a) Aus der Stichprobenbeschreibung kann entnommen werden, dass $`r exr_ehe_burnout$jmv_res_desc$num1`$ unverheiratete und $`r exr_ehe_burnout$jmv_res_desc$num2`$ verheiratete Ärztinnen den Fragebogen abgeschlossen haben.
b) Die unverheirateten Ärztinnen $M = `r round(exr_ehe_burnout$jmv_res_desc$mean1,2)`$ scheiden durchschnittlich höher ab als die verheirateten Ärztinnen $M = `r round(exr_ehe_burnout$jmv_res_desc$mean2,2)`$. Dieser Befund beschränkt sich ohne statistischen Test auf die Stichprobe. Deshalb wurde darin das Wort signifikant nicht verwendet.
c) Die Forscherin will zeigen, dass unverheiratete Ärztinnen ein durchhschnittlich höheres Burnout-Risiko haben als verheiratete und zwar nicht nur in der Stichprobe sondern auch ich der Population. Das durchschnittliche Burnout-Risiko in der Population ist der Erwartungswert des Burnout-Risiko und wird mit $\mu$ bezeichnet. Die Forscherin will also zeigen, dass $H_1: \mu_\text{unverheiratet} > \mu_\text{verheiratet}$. Demgegenüber steht die Nullhypothese, dass dies nicht so ist oder das gar das Gegenteil der Fall sein könnte also $H_0: \mu_\text{unverheiratet} \leq \mu_\text{verheiratet}$. Die Hypothese ist also einseitig gestellt.
d) Ein einseitiger Welch-Test ergibt, dass der durchschnittliche Burnout-Wert bei unverheirateten Ärztinnen ($M = `r round(exr_ehe_burnout$jmv_res_desc$mean1,2)`$, $SD = `r round(exr_ehe_burnout$jmv_res_desc$sd1,2)`$, $N = `r exr_ehe_burnout$jmv_res_desc$num1`$) signifikant höher ist als bei verheirateten Ärztinnen ($M = `r round(exr_ehe_burnout$jmv_res_desc$mean2,2)`$, $SD = `r round(exr_ehe_burnout$jmv_res_desc$sd2,2)`$, $N = `r exr_ehe_burnout$jmv_res_desc$num2`$), $t(`r round(exr_ehe_burnout$jmv_res_test$dfwelc,1)`) = `r round(exr_ehe_burnout$jmv_res_test$statwelc,2)`$, $`r report_p(exr_ehe_burnout$jmv_res_test$pwelc)`, d = `r round(exr_ehe_burnout$jmv_res_test$eswelc,3)`$.
:::

::: {.exercise  #tagname5}
<!-- 
Ziel: 
- Berichten und Werte erklären
-->
TODO: Exercise body
:::

:::{.solution}
TODO: solution body
:::
